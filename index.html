<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>تطبيق صناعة الناي والكولة</title>
  <style>
    /* إعداد متغيرات الألوان */
    :root {
      --main-bg: #222;
      --accent: #ffd700;
      --text-color: #fff;
      --input-bg: #333;
      --input-border: #444;
      --hover-bg: #e6c200;
      --active-bg: #d4af37;
    }

    /* إعادة تعيين الأنماط الأساسية */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(45deg, #000, #222, #444, #000);
      background-size: 400% 400%;
      animation: gradientBG 10s ease infinite;
      color: var(--text-color);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
      direction: rtl;
    }

    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .container {
      background-color: var(--main-bg);
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.7);
      width: 100%;
      max-width: 1000px;
      animation: fadeInUp 1s ease-out;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .tabs {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 10px;
    }

    .tab-button {
      background-color: var(--input-bg);
      color: var(--text-color);
      border: none;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      border-radius: 5px;
      transition: background 0.3s ease;
    }

    .tab-button.active {
      background-color: var(--accent);
      color: #000;
    }

    .tab-button:hover {
      background-color: var(--hover-bg);
      animation: shake 0.5s ease-in-out;
    }

    @keyframes shake {
      0% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      50% { transform: translateX(5px); }
      75% { transform: translateX(-5px); }
      100% { transform: translateX(0); }
    }

    .tab-content {
      display: none;
      animation: fadeInUp 0.5s ease-out;
    }

    .tab-content.active {
      display: block;
    }

    .section-header {
      font-size: 22px;
      margin-bottom: 10px;
      color: var(--accent);
      text-align: center;
    }

    label {
      font-size: 16px;
      margin-bottom: 5px;
      display: block;
    }

    .tooltip {
      font-size: 14px;
      color: #aaa;
      margin-bottom: 10px;
    }

    input[type="number"],
    select {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border: 1px solid var(--input-border);
      border-radius: 5px;
      background-color: var(--input-bg);
      color: var(--text-color);
      transition: background-color 0.3s ease, border 0.3s ease;
      margin-bottom: 15px;
    }

    input[type="number"]:focus,
    select:focus {
      background-color: #444;
      border-color: var(--accent);
      outline: none;
    }

    .button-group {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    button {
      background-color: var(--accent);
      color: #000;
      border: none;
      padding: 10px 20px;
      font-size: 16px;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.3s ease;
      flex: 1;
      min-width: 120px;
    }

    button:hover {
      background-color: var(--hover-bg);
      transform: scale(1.05);
    }

    button:active {
      transform: scale(0.95);
      background-color: var(--active-bg);
    }

    .result-section {
      margin-top: 20px;
    }

    .result-table {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-top: 15px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background-color: #333;
      border-radius: 10px;
      overflow: hidden;
    }

    th, td {
      padding: 10px;
      text-align: center;
      border: 1px solid #444;
    }

    th {
      background-color: #444;
      font-size: 18px;
      color: var(--accent);
    }

    td {
      font-size: 16px;
      color: var(--text-color);
    }

    .copy-button {
      background-color: #555;
      color: var(--accent);
      border: none;
      padding: 5px 10px;
      font-size: 14px;
      border-radius: 3px;
      cursor: pointer;
      margin-top: 10px;
    }

    .copy-button:hover {
      background-color: #666;
    }

    .error {
      border-color: red !important;
    }

    .footer {
      margin-top: 30px;
      font-size: 14px;
      color: var(--accent);
      text-align: center;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 1s ease, transform 1s ease;
    }

    .footer.show {
      opacity: 1;
      transform: translateY(0);
    }

    .footer a {
      color: var(--accent);
      text-decoration: none;
    }

    .footer a:hover {
      text-decoration: underline;
    }

    @media (max-width: 768px) {
      .result-table {
        grid-template-columns: 1fr;
      }
      .button-group {
        flex-direction: column;
      }
    }

    /* تنسيق مخصص لقسم السلم المقامي */
    .scale-selection {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 10px;
    }

    .scale-btn {
      padding: 10px 15px;
      font-size: 16px;
    }

    .scale-result {
      margin-top: 20px;
    }

    /* تصميم شبكة البطاقات لعرض النغمات */
    .scale-grid {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
    }

    .scale-card {
      background-color: var(--input-bg);
      padding: 10px 15px;
      border: 1px solid var(--input-border);
      border-radius: 5px;
      text-align: center;
      min-width: 80px;
      transition: transform 0.3s ease;
    }

    .scale-card:hover {
      transform: scale(1.05);
    }

    .scale-arrow {
      font-size: 24px;
      color: var(--accent);
      align-self: center;
    }
    
    /* زر تشغيل وإيقاف الصوت لكل نغمة (تبديل) */
    .play-note {
      margin-top: 5px;
      background-color: var(--accent);
      border: none;
      color: #000;
      padding: 5px;
      border-radius: 3px;
      cursor: pointer;
      font-size: 14px;
    }
    
    .play-note:hover {
      background-color: var(--hover-bg);
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="tabs">
      <button class="tab-button active" onclick="showTab('nai')">صناعة الناي</button>
      <button class="tab-button" onclick="showTab('kawala')">صناعة الكولة</button>
      <button class="tab-button" onclick="showTab('scale')"> مقام الراست من كل الدرجات</button>
    </div>

    <!-- قسم صناعة الناي -->
    <div id="nai" class="tab-content active">
      <div class="section-header">حساب مقاسات الناي - الثقوب والفكوك</div>
      <p class="tooltip">أدخل الطول الإجمالي للناي بالسنتيمتر. ستظهر لك المواقع الدقيقة للثقوب وأطوال الفكوك.</p>
      <label for="length">طول الناي (سم):</label>
      <input type="number" id="length" placeholder="مثال: 53">
      <div class="button-group">
        <button onclick="calculateAll()">حساب</button>
        <button onclick="resetSection('nai')">إعادة تعيين</button>
      </div>
      <div id="naiResults" class="result-section"></div>

      <hr style="margin:20px 0; border: 1px solid #444;">

      <div class="section-header">حساب قطر الرداد بناءً على قطر الخزنة</div>
      <p class="tooltip">أدخل قطر الخزنة بالسنتيمتر لحساب قطر الرداد بدقة.</p>
      <label for="khaznaDiameter">قطر الخزنة (سم):</label>
      <input type="number" id="khaznaDiameter" placeholder="مثال: 1.8">
      <div class="button-group">
        <button onclick="calculateRadadDiameter()">حساب قطر الرداد</button>
        <button onclick="resetInput('khaznaDiameter','radadResult')">إعادة تعيين</button>
      </div>
      <div id="radadResult" class="result-section"></div>
    </div>

    <!-- قسم صناعة الكولة -->
    <div id="kawala" class="tab-content">
      <div class="section-header">حساب أطوال الفكوك وأماكن الثقوب للكولة</div>
      <p class="tooltip">أدخل الطول الإجمالي للكولة بالسنتيمتر لحساب المواقع والأطوال بدقة.</p>
      <label for="totalLength">طول الكولة (سم):</label>
      <input type="number" id="totalLength" placeholder="مثال: 56">
      <div class="button-group">
        <button onclick="calculateKawala()">حساب</button>
        <button onclick="resetSection('kawala')">إعادة تعيين</button>
      </div>
      <div id="kawalaResults" class="result-section"></div>
    </div>

    <!-- قسم السلم المقامي -->
    <div id="scale" class="tab-content">
      <div class="section-header">استكشف مقام الراست من كل الدرجات</div>
      <p class="tooltip">اختر الدرجة الموسيقية لعرض السلم المقامي الخاص بها مع معلومات مفصلة عن النغمات والفواصل.</p>
      <div class="scale-selection">
        <select id="scaleSelect">
          <option value="دو">دو</option>
          <option value="ري بيمول">ري بيمول</option>
          <option value="ري">ري</option>
          <option value="مي بيمول">مي بيمول</option>
          <option value="مي">مي</option>
          <option value="فا">فا</option>
          <option value="صول بيمول">صول بيمول</option>
          <option value="صول">صول</option>
          <option value="لا بيمول">لا بيمول</option>
          <option value="لا">لا</option>
          <option value="سي بيمول">سي بيمول</option>
          <option value="سي">سي</option>
          <!-- خيار علامات الثلاث ارباع -->
          <option value="علامات الثلاث ارباع">علامات الثلاث ارباع</option>
        </select>
        <button onclick="showScale()" class="tab-button scale-btn">عرض السلم</button>
      </div>
      <div id="scaleResult" class="result-section scale-result"></div>
    </div>

    <div class="footer">
      تصميم وتطوير:
      <a href="https://www.facebook.com/kawana667788/" target="_blank">خالد باشا</a>
      و
      <a href="https://www.facebook.com/profile.php?id=100006318275944" target="_blank">بدر محمد</a>
      - 
      <a href="https://www.facebook.com/groups/501641503562283" target="_blank">جروب تعليم آلة الكولة على الفيسبوك</a>
      <br>
      هذا التطبيق مجاني ولا يسمح ببيعه.
    </div>
  </div>

  <script>
    // كائن لتخزين عناصر الصوت لتفعيل خاصية التبديل (تشغيل/إيقاف)
    var audioPlayers = {};

    // متغيرات لتتبع النغمة المشغلة حالياً وزر التشغيل الخاص بها
    var currentPlaying = null;
    var currentButton = null;

    // بيانات سلالم المقامات
    const scales = {
      "دو": "دو - ري - مي نصف بيمول - فا - صول - لا - سي نصف بيمول - دو",
      "ري بيمول": "ري بيمول - مي بيمول - فا نصف بيمول - صول بيمول - لا بيمول - سي بيمول - دو نصف بيمول - ري بيمول",
      "ري": "ري - مي - فا نصف دييز - صول - لا - سي - دو نصف دييز - ري",
      "مي بيمول": "مي بيمول - فا - صول نصف بيمول - لا بيمول - سي بيمول - دو - ري نصف بيمول - مي بيمول",
      "مي": "مي - فا دييز - صول نصف دييز - لا - سي - دو دييز - ري نصف دييز - مي",
      "فا": "فا - صول - لا نصف بيمول - سي بيمول - دو - ري - مي نصف بيمول - فا",
      "صول بيمول": "صول بيمول - لا بيمول - لا نصف دييز - سي - ري بيمول - مي بيمول - فا نصف بيمول - صول بيمول",
      "صول": "صول - لا - سي نصف بيمول - دو - ري - مي - فا نصف دييز - صول",
      "لا بيمول": "لا بيمول - سي بيمول - دو نصف بيمول - ري بيمول - مي بيمول - فا - صول نصف بيمول - لا بيمول",
      "لا": "لا - سي - دو نصف دييز - ري - مي - فا دييز - صول نصف دييز - لا",
      "سي بيمول": "سي بيمول - دو - ري نصف بيمول - مي بيمول - فا - صول - لا نصف بيمول - سي بيمول",
      "سي": "سي - دو دييز - ري نصف دييز - مي - فا دييز - صول دييز - لا نصف دييز - سي",
      // خيار علامات الثلاث ارباع مع العلامات المطلوبة
      "سلم موسيقي كامل": "ري نصف بيمول - دو نصف دييز - مي نصف بيمول - فا نصف دييز - صول نصف بيمول - لا نصف بيمول - لا نصف دييز - سي نصف بيمول - سي نصف دييز"
    };

    // تحديث كائن ربط أسماء النغمات بروابط الأصوات
    const noteAudioMapping = {
      "دو": "https://dl.dropboxusercontent.com/scl/fi/ody6hdacpjd31kxm37cbc/.mp3?rlkey=r74goqb6l6ll07ham3pytufkp",
      "دو دييز": "https://dl.dropboxusercontent.com/scl/fi/sbiblojbrx9hnvxmfqk18/.mp3?rlkey=ey7yp6k60402fje5r49bx8qvf",
      "دو نصف دييز": "https://dl.dropboxusercontent.com/scl/fi/ib8sd1onvt5g477lvrl1f/.mp3?rlkey=tsb4dxq6gw4jtlcteb8cla2x7",
      "دو نصف بيمول": "https://dl.dropboxusercontent.com/scl/fi/88wtah8498a8fgrrvt5xt/.mp3?rlkey=kibu0qlj4t2o2fz80lmx8c4pj",
      "ري بيمول": "https://dl.dropboxusercontent.com/scl/fi/yy3ifpy2142xq3xu4l1d8/.mp3?rlkey=dpr4me512o40x2c9fasznpg79",
      "ري": "https://dl.dropboxusercontent.com/scl/fi/8pxldyaees75u1spht862/.mp3?rlkey=ccn2nwzs85crys03yeiqcujpa",
      "ري نصف بيمول": "https://dl.dropboxusercontent.com/scl/fi/vmdn5k03qjgig5ylmj6ac/.mp3?rlkey=hh4f1rb5yivcdhfgii9m9tltz",
      "ري دييز": "https://dl.dropboxusercontent.com/scl/fi/0j8h4qt97z5a36pzl7g78/.mp3?rlkey=z9emnyr1m263d5uokbdvluzb7",
      "ري نصف دييز": "https://dl.dropboxusercontent.com/scl/fi/wko15s4ruckimoykr6mmt/.mp3?rlkey=ribtzeb7a4rpczvpqmesuk8aq",
      "مي بيمول": "https://dl.dropboxusercontent.com/scl/fi/0j8h4qt97z5a36pzl7g78/.mp3?rlkey=z9emnyr1m263d5uokbdvluzb7",
      "مي": "https://dl.dropboxusercontent.com/scl/fi/xc15925yrwmr0qu8enqc2/.mp3?rlkey=kd75wwwn5gqdm86repioemyus",
      "مي نصف بيمول": "https://dl.dropboxusercontent.com/scl/fi/b2903mcw6rnmmx3uwqhon/.mp3?rlkey=wef2w2a3xipapzz8fh4mbgc0b",
      "فا": "https://dl.dropboxusercontent.com/scl/fi/40aj5g1g1bq3ocz5baze7/.mp3?rlkey=3uafizgrgpli4xh87hijjugh7",
      "فا دييز": "https://dl.dropboxusercontent.com/scl/fi/6tyfjl7wzjeax2hsbei91/.mp3?rlkey=6nrf2cix5j3d0i4eyqs03ldlz",
      "فا نصف بيمول": "https://dl.dropboxusercontent.com/scl/fi/yxjrb33ysgcbdypd9zznx/.mp3?rlkey=ftmy2ws9r7go3uiebtqv0qh0g",
      "فا نصف دييز": "https://dl.dropboxusercontent.com/scl/fi/87jluxjsi16iz3ip5lrc3/.mp3?rlkey=fza7syc9v4h4zunsa34np37ay",
      "صول بيمول": "https://dl.dropboxusercontent.com/scl/fi/6tyfjl7wzjeax2hsbei91/.mp3?rlkey=6nrf2cix5j3d0i4eyqs03ldlz",
      "صول": "https://dl.dropboxusercontent.com/scl/fi/a38fetx5cz0bvkuc3nfb3/.mp3?rlkey=cqkvyi6mztugsgqtp9jgz3cd6",
      "صول دييز": "https://dl.dropboxusercontent.com/scl/fi/30d6via79cwrd4imio90x/.mp3?rlkey=0le22kqx0ae3tpf3nhbme0onc",
      "صول نصف دييز": "https://dl.dropboxusercontent.com/scl/fi/exv3wirafp55qms58tuig/.mp3?rlkey=qbzc80k5gczl2j0gbosrjmhky",
      "صول نصف بيمول": "https://dl.dropboxusercontent.com/scl/fi/j2va1j0ujuka43pcyu4j1/.mp3?rlkey=x7j3fwyslu8qe4uo8n1t9nkne",
      "لا بيمول": "https://dl.dropboxusercontent.com/scl/fi/30d6via79cwrd4imio90x/.mp3?rlkey=0le22kqx0ae3tpf3nhbme0onc",
      "لا": "https://dl.dropboxusercontent.com/scl/fi/3aiehhnhxgv2drmxdtl5i/.mp3?rlkey=0kiewx92otb3hct1zn64s8nj0",
      "لا دييز": "https://dl.dropboxusercontent.com/scl/fi/zmitrsq6ezkb3ojb142lv/.mp3?rlkey=1832ahcpn7hwwlyw2d9l8xr27",
      "لا نصف بيمول": "https://dl.dropboxusercontent.com/scl/fi/pznwkre0vjncoyzfzw2io/.mp3?rlkey=w1jnlz8qu93aj8z46v1q7m1eq",
      "لا نصف دييز": "https://dl.dropboxusercontent.com/scl/fi/ls3nxm3i5lya8w76of9dr/.mp3?rlkey=uq7poj9svl0javs9adgcernkn",
      "سي بيمول": "https://dl.dropboxusercontent.com/scl/fi/zmitrsq6ezkb3ojb142lv/.mp3?rlkey=1832ahcpn7hwwlyw2d9l8xr27",
      "سي": "https://dl.dropboxusercontent.com/scl/fi/lrqxlgtf2xgu6fwqeo3qx/.mp3?rlkey=88r2z4dqix2wl9inb9abjp3i1",
      "سي نصف بيمول": "https://dl.dropboxusercontent.com/scl/fi/1yy51ldrmkupp6voqzxcv/.mp3?rlkey=j5td5yffe23v3app91fobtiq0",
      "سي نصف دييز": "https://dl.dropboxusercontent.com/scl/fi/rgf4qmqwxuoszh9iycy3j/.mp3?rlkey=88bpff50f5b41mnf084aybl7i"
    };

    // دالة تبديل تشغيل/إيقاف الصوت باستخدام زر (تمرير العنصر والنغمة)
    function togglePlay(btn, note) {
      // إذا كانت النغمة المطلوبة هي النغمة التي تعمل حالياً، قم بإيقافها
      if (currentPlaying === note && audioPlayers[note] && !audioPlayers[note].paused) {
        audioPlayers[note].pause();
        audioPlayers[note].currentTime = 0;
        btn.innerText = "▶";
        currentPlaying = null;
        currentButton = null;
      } else {
        // إذا كانت هناك نغمة أخرى تعمل، قم بإيقافها وتحديث رمز زرها
        if (currentPlaying && audioPlayers[currentPlaying] && !audioPlayers[currentPlaying].paused) {
          audioPlayers[currentPlaying].pause();
          audioPlayers[currentPlaying].currentTime = 0;
          if (currentButton) {
            currentButton.innerText = "▶";
          }
        }
        // تشغيل النغمة المطلوبة
        if (!audioPlayers[note]) {
          audioPlayers[note] = new Audio(noteAudioMapping[note]);
        }
        audioPlayers[note].play();
        btn.innerText = "■";
        currentPlaying = note;
        currentButton = btn;
        // عند انتهاء تشغيل النغمة، استعادة رمز التشغيل وإعادة تعيين المتغيرات
        audioPlayers[note].onended = function() {
          btn.innerText = "▶";
          currentPlaying = null;
          currentButton = null;
        };
      }
    }

    // عرض السلم المقامي مع البطاقات وزر تشغيل الصوت لكل نغمة
    function showScale() {
      const selectedScale = document.getElementById("scaleSelect").value;
      const scaleResultDiv = document.getElementById("scaleResult");
      const scaleString = scales[selectedScale] || "السلم غير متوفر";
      const notes = scaleString.split(" - ");
      
      let html = <div class="scale-grid">;
      notes.forEach((note, index) => {
        html += 
          <div class="scale-card">
            <div class="note-index">${index + 1}</div>
            <div class="note-name">${note}</div>
            <button class="play-note" onclick="togglePlay(this, '${note}')">▶</button>
          </div>;
        if (index < notes.length - 1) {
          html += <div class="scale-arrow">→</div>;
        }
      });
      html += </div>;
      scaleResultDiv.innerHTML = html;
    }

    // تبديل علامات التبويب
    function showTab(tabName) {
      document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
      document.getElementById(tabName).classList.add('active');
      document.querySelector(button[onclick="showTab('${tabName}')"]).classList.add('active');
    }

    // تمييز الحقول الخاطئة
    function validateInput(inputId) {
      const input = document.getElementById(inputId);
      if (!input.value || parseFloat(input.value) <= 0) {
        input.classList.add('error');
        return false;
      } else {
        input.classList.remove('error');
        return true;
      }
    }

    // وظيفة لحساب الناي
    function calculateAll() {
      if (!validateInput("length")) {
        alert("الرجاء إدخال طول صحيح للناي!");
        return;
      }
      const totalLength = parseFloat(document.getElementById("length").value);

      // نسب الثقوب الأصلية
      const holePositionsRatios = [7.3 / 53, 9.7 / 53, 12.1 / 53, 16.9 / 53, 19.3 / 53, 21.5 / 53, 0.5];
      const holes = holePositionsRatios.map(ratio => (ratio * totalLength).toFixed(2));

      // إنشاء جداول النتائج
      let resultHTML = 
        <div class="result-table">
          <table>
            <thead>
              <tr><th colspan="2">أماكن الثقوب</th></tr>
              <tr><th>الثقب</th><th>المسافة (سم)</th></tr>
            </thead>
            <tbody>
              <tr><td>الثقب الأول</td><td>${holes[0]}</td></tr>
              <tr><td>الثقب الثاني</td><td>${holes[1]}</td></tr>
              <tr><td>الثقب الثالث</td><td>${holes[2]}</td></tr>
              <tr><td>الثقب الرابع</td><td>${holes[3]}</td></tr>
              <tr><td>الثقب الخامس</td><td>${holes[4]}</td></tr>
              <tr><td>الثقب السادس</td><td>${holes[5]}</td></tr>
              <tr><td>الثقب السابع (الخلفي)</td><td>${holes[6]}</td></tr>
            </tbody>
          </table>
          <table>
            <thead>
              <tr><th colspan="2">أطوال الفكوك</th></tr>
              <tr><th>الفك</th><th>الطول (سم)</th></tr>
            </thead>
            <tbody>
      ;

      // الحساب بالنسبة للطول الأصلي 59.2 سم وأطوال الفكوك الأصلية
      const originalNaiLength = 59.2;
      const originalFukuk = [6.4, 6.5, 6.6, 6.7, 6.8, 7, 7.1, 7.2, 4.9];
      const ratio = totalLength / originalNaiLength;
      const newFukuk = originalFukuk.map(length => (length * ratio).toFixed(2));
      const fukukNames = ["الرداد", "الفك الثاني", "الفك الثالث", "الفك الرابع", "الفك الخامس", "الفك السادس", "الفك السابع", "الفك الثامن", "الخزنة"];

      newFukuk.forEach((length, index) => {
        resultHTML += <tr><td>${fukukNames[index]}</td><td>${length}</td></tr>;
      });

      resultHTML += 
            </tbody>
          </table>
        </div>
        <button class="copy-button" onclick="copyResult('naiResults')">نسخ النتائج</button>
      ;
      document.getElementById("naiResults").innerHTML = resultHTML;
    }

    // حساب قطر الرداد
    function calculateRadadDiameter() {
      if (!validateInput("khaznaDiameter")) {
        alert("الرجاء إدخال قطر خزنة صحيح!");
        return;
      }
      const khaznaDiameter = parseFloat(document.getElementById("khaznaDiameter").value);
      const radadDiameter = (khaznaDiameter - (khaznaDiameter * 0.191)).toFixed(2);
      document.getElementById("radadResult").innerHTML = <p>قطر الرداد: ${radadDiameter} سم</p>
        <button class="copy-button" onclick="copyResult('radadResult')">نسخ النتيجة</button>;
    }

    // حساب الكولة
    function calculateKawala() {
      if (!validateInput("totalLength")) {
        alert("الرجاء إدخال طول الكولة!");
        return;
      }
      const totalLength = parseFloat(document.getElementById("totalLength").value);

      // نسب الفكوك للكولة
      const jawRatios = [1.9, 14.3, 14.8, 16.4, 8.6];
      const sumJawRatios = jawRatios.reduce((a, b) => a + b, 0);
      const jawLengths = jawRatios.map(ratio => (ratio / sumJawRatios) * totalLength);

      // نسب الثقوب للكولة
      const holePositionsRatios = [8.6 / 56, 12.9 / 56, 17.2 / 56, 23.5 / 56, 27.8 / 56, 32.1 / 56];
      const holes = holePositionsRatios.map(ratio => (ratio * totalLength).toFixed(2));

      let resultHTML = 
        <div class="result-table">
          <table>
            <thead>
              <tr><th colspan="2">أماكن الثقوب</th></tr>
              <tr><th>الثقب</th><th>المسافة (سم)</th></tr>
            </thead>
            <tbody>
              <tr><td>الثقب الأول</td><td>${holes[0]}</td></tr>
              <tr><td>الثقب الثاني</td><td>${holes[1]}</td></tr>
              <tr><td>الثقب الثالث</td><td>${holes[2]}</td></tr>
              <tr><td>الثقب الرابع</td><td>${holes[3]}</td></tr>
              <tr><td>الثقب الخامس</td><td>${holes[4]}</td></tr>
              <tr><td>الثقب السادس</td><td>${holes[5]}</td></tr>
            </tbody>
          </table>
          <table>
            <thead>
              <tr><th colspan="2">أطوال الفكوك</th></tr>
              <tr><th>الفك</th><th>الطول (سم)</th></tr>
            </thead>
            <tbody>
      ;
      const fukukNames = ["الرداد", "الفك الثاني", "الفك الثالث", "الفك الرابع", "فك الخزنة"];
      jawLengths.forEach((length, index) => {
        resultHTML += <tr><td>${fukukNames[index]}</td><td>${length.toFixed(2)}</td></tr>;
      });
      resultHTML += 
            </tbody>
          </table>
        </div>
        <button class="copy-button" onclick="copyResult('kawalaResults')">نسخ النتائج</button>
      ;
      document.getElementById("kawalaResults").innerHTML = resultHTML;
    }

    // زر نسخ النتائج إلى الحافظة
    function copyResult(sectionId) {
      const section = document.getElementById(sectionId);
      const range = document.createRange();
      range.selectNode(section);
      window.getSelection().removeAllRanges();
      window.getSelection().addRange(range);
      try {
        document.execCommand('copy');
        alert('تم نسخ النتائج إلى الحافظة');
      } catch (err) {
        alert('تعذر نسخ النتائج');
      }
      window.getSelection().removeAllRanges();
    }

    // وظائف إعادة التعيين لمسح المدخلات والنتائج لكل قسم
    function resetSection(sectionId) {
      if(sectionId === 'nai') {
        document.getElementById("length").value = "";
        document.getElementById("naiResults").innerHTML = "";
        document.getElementById("khaznaDiameter").value = "";
        document.getElementById("radadResult").innerHTML = "";
        removeError("length");
        removeError("khaznaDiameter");
      } else if(sectionId === 'kawala') {
        document.getElementById("totalLength").value = "";
        document.getElementById("kawalaResults").innerHTML = "";
        removeError("totalLength");
      }
    }

    function resetInput(inputId, resultId) {
      document.getElementById(inputId).value = "";
      document.getElementById(resultId).innerHTML = "";
      removeError(inputId);
    }

    function removeError(inputId) {
      document.getElementById(inputId).classList.remove('error');
    }

    // إظهار الفوتر بعد تحميل الصفحة
    document.addEventListener("DOMContentLoaded", function() {
      setTimeout(() => {
        document.querySelector('.footer').classList.add('show');
      }, 1000);
    });
  </script>
</body>
</html>
